(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[413],{333:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var r=n(5155),a=n(4016),o=n(2115);function s(){let[e,t]=(0,o.useState)([]),[n,s]=(0,o.useState)({amount:"",source:"Salary",description:"",date:""}),[i,c]=(0,o.useState)(null),[l,d]=(0,o.useState)(null),[u,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{fetch("http://localhost:5002/dashboard",{credentials:"include"}).then(e=>e.json()).then(e=>{e.user&&c(e.user)}).catch(e=>console.error(e))},[]),(0,o.useEffect)(()=>{fetch("http://localhost:5002/income",{credentials:"include"}).then(e=>{if(!e.ok)throw Error("Failed to fetch incomes");return e.json()}).then(e=>{Array.isArray(e)?t(e):(console.error("API did not return an array",e),t([]))}).catch(e=>{console.error(e),t([])})},[]);let m=async r=>{if(r.preventDefault(),!i)return alert("User not loaded yet");let a={...n,amount:Number(n.amount),userId:i._id};if(l){let n=await fetch("http://localhost:5002/income/".concat(l),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}),r=await n.json();n.ok?(t(e.map(e=>e._id===l?{...e,...a}:e)),d(null),s({amount:"",source:"Salary",description:"",date:""})):alert(r.message||"Error updating income")}else{let n=await fetch("http://localhost:5002/income",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}),r=await n.json();n.ok?(t([...e,r]),s({amount:"",source:"Salary",description:"",date:""})):alert(r.message||"Error adding income")}},p=async n=>{let r=await fetch("http://localhost:5002/income/".concat(n),{method:"DELETE",credentials:"include"}),a=await r.json();r.ok?t(e.filter(e=>e._id!==n)):alert(a.message||"Error deleting income")},j=[...e].sort((e,t)=>{let n,r;if(!u)return 0;let{key:a,direction:o}=u;return("amount"===a?(n=Number(e.amount),r=Number(t.amount)):"date"===a?(n=new Date(e.date).getTime(),r=new Date(t.date).getTime()):(n=String(e[a]),r=String(t[a])),n<r)?"asc"===o?-1:1:n>r?"asc"===o?1:-1:0}),x=e=>{let t="asc";u&&u.key===e&&"asc"===u.direction&&(t="desc"),h({key:e,direction:t})},f=e=>u&&u.key===e?"asc"===u.direction?" ↑":" ↓":"";return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"Income"}),i&&(0,r.jsxs)("p",{children:["Welcome, ",i.username,"!"]}),(0,r.jsxs)("form",{onSubmit:m,style:{marginBottom:"20px"},children:[(0,r.jsx)("input",{type:"number",placeholder:"Amount",value:n.amount,onChange:e=>s({...n,amount:e.target.value}),required:!0}),(0,r.jsxs)("select",{value:n.source,onChange:e=>s({...n,source:e.target.value}),required:!0,children:[(0,r.jsx)("option",{value:"Salary",children:"\uD83D\uDCBC Salary"}),(0,r.jsx)("option",{value:"Freelance",children:"\uD83D\uDDA5 Freelance"}),(0,r.jsx)("option",{value:"Investments",children:"\uD83D\uDCC8 Investments"}),(0,r.jsx)("option",{value:"Gifts",children:"\uD83C\uDF81 Gifts"}),(0,r.jsx)("option",{value:"Other",children:"✨ Other"})]}),(0,r.jsx)("input",{type:"text",placeholder:"Description",value:n.description||"",onChange:e=>s({...n,description:e.target.value})}),(0,r.jsx)("input",{type:"date",value:n.date,onChange:e=>s({...n,date:e.target.value}),required:!0}),(0,r.jsx)("button",{type:"submit",children:l?"Update Income":"Add Income"})]}),(0,r.jsxs)("table",{border:1,cellPadding:10,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsxs)("th",{onClick:()=>x("amount"),children:["Amount",f("amount")]}),(0,r.jsxs)("th",{onClick:()=>x("source"),children:["Source",f("source")]}),(0,r.jsxs)("th",{onClick:()=>x("description"),children:["Description",f("description")]}),(0,r.jsxs)("th",{onClick:()=>x("date"),children:["Date",f("date")]}),(0,r.jsx)("th",{children:"Modify"})]})}),(0,r.jsx)("tbody",{children:j.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.amount}),(0,r.jsx)("td",{children:e.source}),(0,r.jsx)("td",{children:e.description}),(0,r.jsx)("td",{children:e.date?new Date(e.date).toLocaleDateString():"-"}),(0,r.jsxs)("td",{children:[(0,r.jsx)("button",{onClick:()=>{d(e._id),s({amount:String(e.amount),source:e.source,description:e.description,date:e.date?e.date.split("T")[0]:""})},children:"Edit"}),(0,r.jsx)("button",{onClick:()=>p(e._id),children:"Delete"})]})]},e._id))})]}),(0,r.jsx)(a.A,{incomes:e})]})}},4016:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var r=n(5155),a=n(4466),o=n(6324),s=n(7734),i=n(3697),c=n(3420),l=n(9339),d=n(9386),u=n(4724);function h(e){let{incomes:t}=e,n={};t.forEach(e=>{n[e.source]||(n[e.source]=0),n[e.source]+=Number(e.amount||0)});let h=Object.values(n).reduce((e,t)=>e+t,0),m=Object.entries(n).map(e=>{let[t,n]=e;return{source:t,value:n,percentage:(n/h*100).toFixed(2)}}),p=["#8884d8","#82ca9d","#ffc658","#ff8042","#8dd1e1","#a4de6c","#d0ed57","#8884d8"];return(0,r.jsx)("div",{style:{width:"100%",height:400},children:(0,r.jsx)(a.u,{children:(0,r.jsxs)(o.E,{data:m,layout:"horizontal",margin:{top:20,right:30,left:20,bottom:50},children:[(0,r.jsx)(s.W,{dataKey:"source",type:"category"}),(0,r.jsx)(i.h,{type:"number"}),(0,r.jsx)(c.m,{formatter:e=>"$".concat(e)}),(0,r.jsxs)(l.y,{dataKey:"value",children:[m.map((e,t)=>(0,r.jsx)(d.f,{fill:p[t%p.length]},"cell-".concat(t))),(0,r.jsx)(u.Ze,{dataKey:"percentage",position:"right",content:e=>{let{x:t=0,y:n=0,value:a}=e;return(0,r.jsxs)("text",{x:t,y:Number(n)-5,fill:"#000",textAnchor:"start",children:[a,"%"]})}})]})]})})})}},9418:(e,t,n)=>{Promise.resolve().then(n.bind(n,333))}},e=>{e.O(0,[175,781,441,255,358],()=>e(e.s=9418)),_N_E=e.O()}]);