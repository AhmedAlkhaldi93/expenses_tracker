(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[413],{333:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var r=n(5155),a=n(4016),i=n(2115);let o=n(5704).env.NEXT_PUBLIC_API_URL||"https://expenses-tracker-2m0j.onrender.com";function c(){let[e,t]=(0,i.useState)([]),[n,c]=(0,i.useState)({amount:"",source:"Salary",description:"",date:""}),[s,d]=(0,i.useState)(null),[l,u]=(0,i.useState)(null),[h,m]=(0,i.useState)(null);(0,i.useEffect)(()=>{fetch("".concat(o,"/dashboard"),{credentials:"include"}).then(e=>e.json()).then(e=>{e.user&&d(e.user)}).catch(e=>console.error(e))},[]),(0,i.useEffect)(()=>{fetch("".concat(o,"/income"),{credentials:"include"}).then(e=>{if(!e.ok)throw Error("Failed to fetch incomes");return e.json()}).then(e=>{Array.isArray(e)?t(e):(console.error("API did not return an array",e),t([]))}).catch(e=>{console.error(e),t([])})},[]);let p=async r=>{if(r.preventDefault(),!s)return alert("User not loaded yet");let a={...n,amount:Number(n.amount),userId:s._id};if(l){let n=await fetch("".concat(o,"/income/").concat(l),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}),r=await n.json();n.ok?(t(e.map(e=>e._id===l?{...e,...a}:e)),u(null),c({amount:"",source:"Salary",description:"",date:""})):alert(r.message||"Error updating income")}else{let n=await fetch("".concat(o,"/income"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}),r=await n.json();n.ok?(t([...e,r]),c({amount:"",source:"Salary",description:"",date:""})):alert(r.message||"Error adding income")}},j=async n=>{let r=await fetch("".concat(o,"/income/").concat(n),{method:"DELETE",credentials:"include"}),a=await r.json();r.ok?t(e.filter(e=>e._id!==n)):alert(a.message||"Error deleting income")},x=[...e].sort((e,t)=>{let n,r;if(!h)return 0;let{key:a,direction:i}=h;return("amount"===a?(n=Number(e.amount),r=Number(t.amount)):"date"===a?(n=new Date(e.date).getTime(),r=new Date(t.date).getTime()):(n=String(e[a]),r=String(t[a])),n<r)?"asc"===i?-1:1:n>r?"asc"===i?1:-1:0}),f=e=>{let t="asc";h&&h.key===e&&"asc"===h.direction&&(t="desc"),m({key:e,direction:t})},y=e=>h&&h.key===e?"asc"===h.direction?" ↑":" ↓":"";return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"Income"}),s&&(0,r.jsxs)("p",{children:["Welcome, ",s.username,"!"]}),(0,r.jsxs)("form",{onSubmit:p,style:{marginBottom:"20px"},children:[(0,r.jsx)("input",{type:"number",placeholder:"Amount",value:n.amount,onChange:e=>c({...n,amount:e.target.value}),required:!0}),(0,r.jsxs)("select",{value:n.source,onChange:e=>c({...n,source:e.target.value}),required:!0,children:[(0,r.jsx)("option",{value:"Salary",children:"\uD83D\uDCBC Salary"}),(0,r.jsx)("option",{value:"Freelance",children:"\uD83D\uDDA5 Freelance"}),(0,r.jsx)("option",{value:"Investments",children:"\uD83D\uDCC8 Investments"}),(0,r.jsx)("option",{value:"Gifts",children:"\uD83C\uDF81 Gifts"}),(0,r.jsx)("option",{value:"Other",children:"✨ Other"})]}),(0,r.jsx)("input",{type:"text",placeholder:"Description",value:n.description||"",onChange:e=>c({...n,description:e.target.value})}),(0,r.jsx)("input",{type:"date",value:n.date,onChange:e=>c({...n,date:e.target.value}),required:!0}),(0,r.jsx)("button",{type:"submit",children:l?"Update Income":"Add Income"})]}),(0,r.jsxs)("table",{border:1,cellPadding:10,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsxs)("th",{onClick:()=>f("amount"),children:["Amount",y("amount")]}),(0,r.jsxs)("th",{onClick:()=>f("source"),children:["Source",y("source")]}),(0,r.jsxs)("th",{onClick:()=>f("description"),children:["Description",y("description")]}),(0,r.jsxs)("th",{onClick:()=>f("date"),children:["Date",y("date")]}),(0,r.jsx)("th",{children:"Modify"})]})}),(0,r.jsx)("tbody",{children:x.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.amount}),(0,r.jsx)("td",{children:e.source}),(0,r.jsx)("td",{children:e.description}),(0,r.jsx)("td",{children:e.date?new Date(e.date).toLocaleDateString():"-"}),(0,r.jsxs)("td",{children:[(0,r.jsx)("button",{onClick:()=>{u(e._id),c({amount:String(e.amount),source:e.source,description:e.description,date:e.date?e.date.split("T")[0]:""})},children:"Edit"}),(0,r.jsx)("button",{onClick:()=>j(e._id),children:"Delete"})]})]},e._id))})]}),(0,r.jsx)(a.A,{incomes:e})]})}},4016:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var r=n(5155),a=n(4466),i=n(6324),o=n(7734),c=n(3697),s=n(3420),d=n(9339),l=n(9386),u=n(4724);function h(e){let{incomes:t}=e,n={};t.forEach(e=>{n[e.source]||(n[e.source]=0),n[e.source]+=Number(e.amount||0)});let h=Object.values(n).reduce((e,t)=>e+t,0),m=Object.entries(n).map(e=>{let[t,n]=e;return{source:t,value:n,percentage:(n/h*100).toFixed(2)}}),p=["#8884d8","#82ca9d","#ffc658","#ff8042","#8dd1e1","#a4de6c","#d0ed57","#8884d8"];return(0,r.jsx)("div",{style:{width:"100%",height:400},children:(0,r.jsx)(a.u,{children:(0,r.jsxs)(i.E,{data:m,layout:"horizontal",margin:{top:20,right:30,left:20,bottom:50},children:[(0,r.jsx)(o.W,{dataKey:"source",type:"category"}),(0,r.jsx)(c.h,{type:"number"}),(0,r.jsx)(s.m,{formatter:e=>"$".concat(e)}),(0,r.jsxs)(d.y,{dataKey:"value",children:[m.map((e,t)=>(0,r.jsx)(l.f,{fill:p[t%p.length]},"cell-".concat(t))),(0,r.jsx)(u.Ze,{dataKey:"percentage",position:"right",content:e=>{let{x:t=0,y:n=0,value:a}=e;return(0,r.jsxs)("text",{x:t,y:Number(n)-5,fill:"#000",textAnchor:"start",children:[a,"%"]})}})]})]})})})}},9418:(e,t,n)=>{Promise.resolve().then(n.bind(n,333))}},e=>{e.O(0,[175,781,441,255,358],()=>e(e.s=9418)),_N_E=e.O()}]);