(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[343],{2988:(e,t,n)=>{Promise.resolve().then(n.bind(n,6327))},6327:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i});var a=n(5155),r=n(9580),s=n(2115);let o=n(5704).env.NEXT_PUBLIC_API_URL||"https://expenses-tracker-2m0j.onrender.com";function i(){let[e,t]=(0,s.useState)([]),[n,i]=(0,s.useState)({amount:"",category:"Food",description:"",date:""}),[c,d]=(0,s.useState)(null),[l,u]=(0,s.useState)(null),[h,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{fetch("".concat(o,"/dashboard"),{credentials:"include"}).then(e=>e.json()).then(e=>{e.user&&d(e.user)}).catch(e=>console.error(e))},[]),(0,s.useEffect)(()=>{fetch("".concat(o,"/expenses"),{credentials:"include"}).then(e=>e.json()).then(e=>t(e||[])).catch(e=>console.error(e))},[]);let x=async a=>{if(a.preventDefault(),!c)return void alert("User not loaded yet");let r={...n,amount:Number(n.amount),userId:c._id};if(l){let n=await fetch("".concat(o,"/expenses/").concat(l),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)}),a=await n.json();n.ok?(t(e.map(e=>e._id===l?{...e,...r}:e)),u(null),i({amount:"",category:"Food",description:"",date:""})):alert(a.message||"Error updating expense")}else{let n=await fetch("".concat(o,"/expenses"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(r)}),a=await n.json();n.ok?(t([...e,a]),i({amount:"",category:"Food",description:"",date:""})):alert(a.message||"Error adding expense")}},j=async n=>{let a=await fetch("".concat(o,"/expenses/").concat(n),{method:"DELETE",credentials:"include"}),r=await a.json();a.ok?t(e.filter(e=>e._id!==n)):alert(r.message||"Error deleting expense")},m=[...e].sort((e,t)=>{let n,a;if(!h)return 0;let{key:r,direction:s}=h;return("amount"===r?(n=Number(e.amount),a=Number(t.amount)):"date"===r?(n=new Date(e.date).getTime(),a=new Date(t.date).getTime()):(n=String(e[r]),a=String(t[r])),n<a)?"asc"===s?-1:1:n>a?"asc"===s?1:-1:0}),g=e=>{let t="asc";h&&h.key===e&&"asc"===h.direction&&(t="desc"),p({key:e,direction:t})},y=e=>h&&h.key===e?"asc"===h.direction?" ↑":" ↓":"";return(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{children:"Expenses"}),c&&(0,a.jsxs)("p",{children:["Welcome, ",c.username,"!"]}),(0,a.jsxs)("form",{onSubmit:x,style:{marginBottom:"20px"},children:[(0,a.jsx)("input",{type:"number",placeholder:"Amount",value:n.amount,onChange:e=>i({...n,amount:e.target.value}),required:!0}),(0,a.jsxs)("select",{value:n.category,onChange:e=>i({...n,category:e.target.value}),required:!0,children:[(0,a.jsx)("option",{value:"Food",children:"\uD83C\uDF54 Food"}),(0,a.jsx)("option",{value:"Transport",children:"\uD83D\uDE97 Transport"}),(0,a.jsx)("option",{value:"Bills",children:"\uD83D\uDCA1 Bills"}),(0,a.jsx)("option",{value:"Shopping",children:"\uD83D\uDECD️ Shopping"}),(0,a.jsx)("option",{value:"Other",children:"✨ Other"})]}),(0,a.jsx)("input",{type:"text",placeholder:"Description",value:n.description||"",onChange:e=>i({...n,description:e.target.value})}),(0,a.jsx)("input",{type:"date",value:n.date,onChange:e=>i({...n,date:e.target.value}),required:!0}),(0,a.jsx)("button",{type:"submit",children:l?"Update Expense":"Add Expense"})]}),(0,a.jsxs)("table",{border:1,cellPadding:10,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsxs)("th",{onClick:()=>g("amount"),children:["Amount",y("amount")]}),(0,a.jsxs)("th",{onClick:()=>g("category"),children:["Category",y("category")]}),(0,a.jsxs)("th",{onClick:()=>g("description"),children:["Description",y("description")]}),(0,a.jsxs)("th",{onClick:()=>g("date"),children:["Date",y("date")]}),(0,a.jsx)("th",{children:"Modify"})]})}),(0,a.jsx)("tbody",{children:m.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{children:e.amount}),(0,a.jsx)("td",{children:e.category}),(0,a.jsx)("td",{children:e.description}),(0,a.jsx)("td",{children:e.date?new Date(e.date).toLocaleDateString():"-"}),(0,a.jsxs)("td",{children:[(0,a.jsx)("button",{onClick:()=>{u(e._id),i({amount:String(e.amount),category:e.category,description:e.description,date:e.date?e.date.split("T")[0]:""})},children:"Edit"}),(0,a.jsx)("button",{onClick:()=>j(e._id),children:"Delete"})]})]},e._id))})]}),(0,a.jsx)(r.A,{expenses:e})]})}},9580:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var a=n(5155),r=n(4466),s=n(6324),o=n(7734),i=n(3697),c=n(3420),d=n(9339),l=n(9386),u=n(4724);function h(e){let{expenses:t}=e,n={};t.forEach(e=>{n[e.category]||(n[e.category]=0),n[e.category]+=Number(e.amount||0)});let h=Object.values(n).reduce((e,t)=>e+t,0),p=Object.entries(n).map(e=>{let[t,n]=e;return{category:t,value:n,percentage:(n/h*100).toFixed(2)}}),x=["#8884d8","#82ca9d","#ffc658","#ff8042","#8dd1e1","#a4de6c","#d0ed57","#8884d8"];return(0,a.jsx)("div",{style:{width:"100%",height:400},children:(0,a.jsx)(r.u,{children:(0,a.jsxs)(s.E,{data:p,layout:"horizontal",margin:{top:20,right:30,left:20,bottom:50},children:[(0,a.jsx)(o.W,{dataKey:"category",type:"category"}),(0,a.jsx)(i.h,{type:"number"}),(0,a.jsx)(c.m,{formatter:e=>"$".concat(e)}),(0,a.jsxs)(d.y,{dataKey:"value",children:[p.map((e,t)=>(0,a.jsx)(l.f,{fill:x[t%x.length]},"cell-".concat(t))),(0,a.jsx)(u.Ze,{dataKey:"percentage",position:"right",content:e=>{let{x:t=0,y:n=0,value:r}=e;return(0,a.jsxs)("text",{x:t,y:Number(n)-5,fill:"#000",textAnchor:"start",children:[r,"%"]})}})]})]})})})}}},e=>{e.O(0,[175,781,441,255,358],()=>e(e.s=2988)),_N_E=e.O()}]);